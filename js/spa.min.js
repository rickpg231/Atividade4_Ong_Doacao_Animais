const appContent=document.getElementById("app-content");const mainNavUl=document.querySelector("header nav ul");const metaDescriptionTag=document.querySelector('meta[name="description"]');async function loadContent(url){try{const response=await fetch(url);if(!response.ok){throw new Error(`Erro ao carregar a página: ${response.statusText}`)}const html=await response.text();const parser=new DOMParser;const doc=parser.parseFromString(html,"text/html");const newContent=doc.getElementById("app-content")?.innerHTML||"";const newTitle=doc.querySelector("title")?.textContent;const newMetaDesc=doc.querySelector('meta[name="description"]')?.getAttribute("content");const newNavHtml=doc.querySelector("header nav ul")?.innerHTML;if(!newContent||!newNavHtml){throw new Error("Não foi possível extrair o conteúdo ou o menu da página carregada.")}return{content:newContent,title:newTitle,metaDesc:newMetaDesc,navHtml:newNavHtml}}catch(error){console.error("Falha ao carregar o conteúdo:",error);return{content:"<h1>Erro de Carregamento</h1><p>Não foi possível carregar o conteúdo da página.</p>",title:"Erro"}}}async function navigate(e){const link=e.target.closest("a");if(!link)return;const url=link.href;if(url.startsWith(window.location.origin)||url.startsWith("/")){e.preventDefault();if(url===window.location.href){return}const{content:content,title:title,metaDesc:metaDesc,navHtml:navHtml}=await loadContent(url);appContent.innerHTML=content;if(mainNavUl&&navHtml){mainNavUl.innerHTML=navHtml}if(title){document.title=title}if(metaDesc&&metaDescriptionTag){metaDescriptionTag.setAttribute("content",metaDesc)}window.history.pushState({path:url},title,url);window.scrollTo(0,0)}}function handlePopState(e){const url=window.location.href;if(url.startsWith(window.location.origin)){loadContent(url).then(({content:content,title:title,metaDesc:metaDesc,navHtml:navHtml})=>{if(appContent&&content){appContent.innerHTML=content;if(title)document.title=title;if(metaDesc&&metaDescriptionTag)metaDescriptionTag.setAttribute("content",metaDesc);if(mainNavUl&&navHtml)mainNavUl.innerHTML=navHtml;window.scrollTo(0,0)}})}}document.addEventListener("click",navigate);window.addEventListener("popstate",handlePopState);